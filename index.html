<!DOCTYPE html>
<html>
  <head>
    <title>Gazetter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <!--
    <script src="https://cdn.jsdelivr.net/npm/ol@v8.2.0/dist/ol.js"></script>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v8.2.0/ol.css">
    -->
    <script src="/src/ol/dist/ol.js"></script>
    <link rel="stylesheet" href="/src/ol/ol.css">
    
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

    
    <style type="text/css">

  
      .map {
          height: 400px;
          width: 100%;
      }
        
      /* #mapPlaceholder { width: 100%; height: 100%; padding: 0;} 
      #mapPlaceholder { height: 100px;} */

       
    </style>
    
  </head>
  <body>
       <div data-role="page">
      
      	<div data-role="header">
      		<h1>Gazetter</h1>
      	</div><!-- /header -->
      
      	<div role="main" class="ui-content">
      		<p>Page content goes here.</p>
          <div id="mapPlaceholder" class="map"></div>
      	</div><!-- /content -->
      
      	<div data-role="footer">
      		<h4>Page Footer</h4>
      	</div><!-- /footer -->
      </div><!-- /page -->
    
    
    
    
    <script>
      $(document).ready(function(){
          //$("#mapPlaceholder").height (($(window).height()} - 200);
    
        
        
        let osmLayer = new ol.layer.Tile({
              source: new ol.source.OSM(),
              visible: true
          });
      
          //let vectorLayer;
      
          let map = new ol.Map({
              target: 'mapPlaceholder',
              layers: [
                  osmLayer
                //vectorLayer
              ],
              view: new ol.View({
                  //Somewhere in Germany
                  center: ol.proj.fromLonLat([8.66, 48.88]),
                  //center: geolocation.getPosition(),
                  zoom: 10
              })
          });
          let geolocation = new ol.Geolocation({
                  projection: map.getView().getProjection(),
                  tracking: true
              });
          //create a vector source to add the icon(s) to.
          let vectorSource = new ol.source.Vector({});
          
          geolocation.on('change', function(evt) {
             //save position and set map center
             let pos = geolocation.getPosition();
             map.getView().setCenter(pos);
          
             //create icon at new map center
             let iconFeature = new ol.Feature({
                   geometry: new ol.geom.Point(pos)  
             });

            vectorSource.clear();
             //add icon to vector source
             vectorSource.addFeature(iconFeature);

            
            });
          
          let vectorLayer = new ol.layer.Vector({
              source: vectorSource
          });

          map.addLayer(vectorLayer);
        /*
          var iconStyle = new ol.style.Style({
              image: new ol.style.Icon(({
                anchor: [0.5, 46],
                anchorXUnits: 'fraction',
                anchorYUnits: 'pixels',
                opacity: 0.75,
                src: 'data/icon.png'
             }))
          });
      */

        
        let pointStyle = new ol.style.Style({
              image: new ol.style.Circle({
                  radius: 5,
                  fill: null,
                  stroke: new ol.style.Stroke({color: 'red', width: 1})
              })
          });
          let styleFunction = function(feature) {
              return pointStyle;
          };
      
          //TODO: add code here
      
      });

    </script>
  </body>
</html>
